---
import Layout from '~/layouts/PageLayout.astro';
import PageHero from '~/components/widgets/PageHero.astro';
import Steps from '~/components/widgets/Steps.astro';
import Callout from '~/components/ui/Callout.astro';
import ItemGrid from '~/components/ui/ItemGrid.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';
import { Icon } from 'astro-icon/components';
import CodeBlock from '~/components/ui/CodeBlock.astro';
import { getLatestSpecs } from '~/utils/systemSpecs';

const specs = await getLatestSpecs();

const metadata = {
  title: 'Quick Start Guide',
  description: 'Launch your first Mage-OS store in under 30 minutes with this step-by-step guide.',
  openGraph: {
    images: [{ url: '/og/page/quick-start.png', width: 1200, height: 630 }],
  },
};
---

<Layout metadata={metadata}>
  <PageHero tagline="Get Started" variant="default">
    <Fragment slot="title">Quick Start Guide</Fragment>
    <Fragment slot="subtitle">
      Get from <strong>zero to a working Mage-OS store</strong> in under 30 minutes. This guide is designed for developers,
      merchants evaluating the platform, or anyone wanting a fast local development environment.
    </Fragment>
  </PageHero>

  <section class="px-4 py-16 sm:px-6 mx-auto lg:px-8 max-w-4xl">
    <p class="text-xl text-muted mb-8">
      <strong>Total time:</strong> 20-30 minutes | <strong>Difficulty:</strong> Beginner-friendly
    </p>

    <hr class="border-gray-200 dark:border-gray-700 my-8" />

    <!-- Before You Begin Section -->
    <div
      class="prose prose-lg max-w-none dark:prose-invert dark:prose-headings:text-slate-300 prose-headings:font-heading prose-headings:leading-tighter prose-headings:tracking-tighter prose-headings:font-bold prose-a:text-indigo-600 dark:prose-a:text-indigo-400 prose-code:bg-gray-100 dark:prose-code:bg-gray-800 prose-code:px-1 prose-code:py-0.5 prose-code:rounded"
    >
      <h2>Before You Begin</h2>

      <h3>System Requirements</h3>

      <table>
        <thead>
          <tr>
            <th>Component</th>
            <th>Version Required</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>PHP</td>
            <td>{specs.php.minimum} or {specs.php.recommended}</td>
          </tr>
          <tr>
            <td>Composer</td>
            <td>{specs.composer.minimum}+</td>
          </tr>
          <tr>
            <td>MySQL</td>
            <td>{specs.mysql.recommended}+ (or MariaDB {specs.mariadb.recommended}+)</td>
          </tr>
          <tr>
            <td>OpenSearch</td>
            <td>{specs.opensearch.recommended}+</td>
          </tr>
          <tr>
            <td>Web Server</td>
            <td>Apache {specs.apache.minimum}+ or Nginx {specs.nginx.recommended}+</td>
          </tr>
        </tbody>
      </table>

      <p>
        Need the full list? See <a href="/get-started/system-requirements">System Requirements</a>.
      </p>

      <h3>Choose Your Environment</h3>

      <p>
        <strong>Already have a development environment?</strong> Skip to <a href="#installation-steps"
          >Installation Steps</a
        >.
      </p>

      <p><strong>Need an environment?</strong> We recommend these Docker-based options:</p>

      <table>
        <thead>
          <tr>
            <th>Tool</th>
            <th>Best For</th>
            <th>Setup Time</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><a href="https://ddev.com/">DDEV</a></td>
            <td>Easiest setup, great for beginners</td>
            <td>5 minutes</td>
          </tr>
          <tr>
            <td><a href="https://github.com/markshust/docker-magento">docker-magento</a></td>
            <td>Production-like, excellent docs</td>
            <td>10 minutes</td>
          </tr>
          <tr>
            <td><a href="https://warden.dev/">Warden</a></td>
            <td>Production-like, built for managing multiple environments</td>
            <td>10 minutes</td>
          </tr>
        </tbody>
      </table>

      <p>
        For detailed Docker installation, see the <a href="/get-started/installation#docker-installation"
          >Installation Guide</a
        >.
      </p>
    </div>
  </section>

  <!-- Visual Timeline Overview -->
  <Steps
    id="installation-steps"
    title="Installation Steps"
    subtitle="Follow these six steps to get your Mage-OS store up and running"
    items={[
      {
        title:
          'Step 1: <span class="font-medium">Create Project</span> <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">3-5 min</span>',
        description: 'Use Composer to download Mage-OS and all dependencies into your project directory.',
        icon: 'tabler:package',
      },
      {
        title:
          'Step 2: <span class="font-medium">Create Database</span> <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">1 min</span>',
        description: 'Set up a MySQL or MariaDB database and user for your installation.',
        icon: 'tabler:database',
      },
      {
        title:
          'Step 3: <span class="font-medium">Run Installation</span> <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">5-10 min</span>',
        description: 'Execute the setup installer to configure your store, admin account, and services.',
        icon: 'tabler:settings',
      },
      {
        title:
          'Step 4: <span class="font-medium">Set Permissions & Deploy</span> <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">5-10 min</span>',
        description: 'Configure file permissions, compile dependency injection, and deploy static assets.',
        icon: 'tabler:shield-check',
      },
      {
        title:
          'Step 5: <span class="font-medium">Set Deploy Mode</span> <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">1 min</span>',
        description: 'Choose developer mode for local work or production mode for live stores.',
        icon: 'tabler:toggle-right',
      },
      {
        title:
          'Step 6: <span class="font-medium">Access Your Store</span> <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">Done!</span>',
        description: 'Open your storefront and admin panel to verify everything is working.',
        icon: 'tabler:check',
      },
    ]}
  />

  <!-- Detailed Step Instructions -->
  <section class="px-4 py-16 sm:px-6 mx-auto lg:px-8 max-w-4xl">
    <div
      class="prose prose-lg max-w-none dark:prose-invert dark:prose-headings:text-slate-300 prose-headings:font-heading prose-headings:leading-tighter prose-headings:tracking-tighter prose-headings:font-bold prose-a:text-indigo-600 dark:prose-a:text-indigo-400 prose-code:bg-gray-100 dark:prose-code:bg-gray-800 prose-code:px-1 prose-code:py-0.5 prose-code:rounded"
    >
      <h2 id="step-1" class="flex items-center gap-3">
        <Icon name="tabler:package" class="w-8 h-8 text-icon" />
        Step 1: Create Project
        <span
          class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"
          >3-5 min</span
        >
      </h2>

      <p>Navigate to your web server's document root and create a new project:</p>

      <CodeBlock
        code="composer create-project --repository-url=https://repo.mage-os.org/ mage-os/project-community-edition ."
        lang="bash"
      />

      <p><strong>What this does:</strong></p>

      <ul>
        <li>Downloads Mage-OS Distribution and all dependencies</li>
        <li>Sets up the basic file structure</li>
        <li>Configures Composer autoloading</li>
      </ul>

      <hr class="my-8" />

      <h2 id="step-2" class="flex items-center gap-3">
        <Icon name="tabler:database" class="w-8 h-8 text-icon" />
        Step 2: Create Database
        <span
          class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"
          >1 min</span
        >
      </h2>

      <p>Create an empty database for your Mage-OS installation:</p>

      <CodeBlock
        code={`mysql -u root -p -e "CREATE DATABASE mage_os;"
mysql -u root -p -e "CREATE USER 'mage_os_user'@'localhost' IDENTIFIED BY 'secure_password';"
mysql -u root -p -e "GRANT ALL PRIVILEGES ON mage_os.* TO 'mage_os_user'@'localhost';"
mysql -u root -p -e "FLUSH PRIVILEGES;"`}
        lang="bash"
      />
    </div>

    <Callout type="warning" title="Security Note">
      Replace <code class="bg-yellow-100 dark:bg-yellow-900 px-1 rounded">secure_password</code> with a strong, unique password
      for production environments. Never use default or weak passwords.
    </Callout>

    <div
      class="prose prose-lg max-w-none dark:prose-invert dark:prose-headings:text-slate-300 prose-headings:font-heading prose-headings:leading-tighter prose-headings:tracking-tighter prose-headings:font-bold prose-a:text-indigo-600 dark:prose-a:text-indigo-400 prose-code:bg-gray-100 dark:prose-code:bg-gray-800 prose-code:px-1 prose-code:py-0.5 prose-code:rounded mt-8"
    >
      <hr class="my-8" />

      <h2 id="step-3" class="flex items-center gap-3">
        <Icon name="tabler:settings" class="w-8 h-8 text-icon" />
        Step 3: Run Installation
        <span
          class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"
          >5-10 min</span
        >
      </h2>

      <p>Run the setup installer with your configuration:</p>

      <CodeBlock
        code={`bin/magento setup:install \\
  --base-url=http://yourdomain.local/ \\
  --db-host=localhost \\
  --db-name=mage_os \\
  --db-user=mage_os_user \\
  --db-password=secure_password \\
  --admin-firstname=<your-firstname> \\
  --admin-lastname=<your-lastname> \\
  --admin-email=<your-email@example.com> \\
  --admin-user=<your-username> \\
  --admin-password=<your-secure-password> \\
  --language=en_US \\
  --currency=USD \\
  --timezone=America/New_York \\
  --use-rewrites=1 \\
  --search-engine=opensearch \\
  --opensearch-host=localhost \\
  --opensearch-port=9200`}
        lang="bash"
      />

      <p><strong>Customize these values:</strong></p>

      <table>
        <thead>
          <tr>
            <th>Parameter</th>
            <th>Description</th>
            <th>Example</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>--base-url</code></td>
            <td>Your store URL</td>
            <td><code>http://mystore.local/</code></td>
          </tr>
          <tr>
            <td><code>--db-name</code></td>
            <td>Database name</td>
            <td><code>mage_os</code></td>
          </tr>
          <tr>
            <td><code>--db-user</code></td>
            <td>Database username</td>
            <td><code>mage_os_user</code></td>
          </tr>
          <tr>
            <td><code>--db-password</code></td>
            <td>Database password</td>
            <td>Your secure password</td>
          </tr>
          <tr>
            <td><code>--admin-email</code></td>
            <td>Admin email address</td>
            <td><code>you@example.com</code></td>
          </tr>
          <tr>
            <td><code>--admin-user</code></td>
            <td>Admin login username</td>
            <td><code>admin</code></td>
          </tr>
          <tr>
            <td><code>--admin-password</code></td>
            <td>Admin login password</td>
            <td>Min 7 chars, 1 letter, 1 number</td>
          </tr>
        </tbody>
      </table>

      <hr class="my-8" />

      <h2 id="step-4" class="flex items-center gap-3">
        <Icon name="tabler:shield-check" class="w-8 h-8 text-icon" />
        Step 4: Set Permissions and Deploy
        <span
          class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"
          >5-10 min</span
        >
      </h2>

      <p>After installation completes, set permissions and deploy assets:</p>

      <CodeBlock
        code={`# Set file permissions
find var generated vendor pub/static pub/media app/etc -type f -exec chmod g+w {} +
find var generated vendor pub/static pub/media app/etc -type d -exec chmod g+ws {} +
chmod u+x bin/magento

# Compile dependency injection
bin/magento setup:di:compile

# Deploy static content
bin/magento setup:static-content:deploy -f

# Flush cache
bin/magento cache:flush`}
        lang="bash"
      />

      <hr class="my-8" />

      <h2 id="step-5" class="flex items-center gap-3">
        <Icon name="tabler:toggle-right" class="w-8 h-8 text-icon" />
        Step 5: Set Deploy Mode
        <span
          class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"
          >1 min</span
        >
      </h2>

      <p><strong>For local development:</strong></p>

      <CodeBlock code="bin/magento deploy:mode:set developer" lang="bash" />

      <p>Developer mode provides detailed error messages and disables static file caching for easier debugging.</p>

      <p><strong>For production:</strong></p>

      <CodeBlock code="bin/magento deploy:mode:set production" lang="bash" />

      <p>Production mode enables full caching and optimizations for performance.</p>

      <hr class="my-8" />

      <h2 id="step-6" class="flex items-center gap-3">
        <Icon name="tabler:check" class="w-8 h-8 text-icon" />
        Step 6: Access Your Store
        <span
          class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"
          >Done!</span
        >
      </h2>

      <h3>Storefront</h3>

      <p>Open your browser and navigate to:</p>

      <CodeBlock code="http://yourdomain.local/" lang="text" />

      <p>You should see the default Mage-OS/Magento storefront with the Luma theme.</p>

      <h3>Admin Panel</h3>

      <p>Navigate to:</p>

      <CodeBlock code="http://yourdomain.local/admin" lang="text" />

      <p><strong>Login with:</strong></p>

      <ul>
        <li>
          <strong>Username:</strong>
          The value you specified for <code>--admin-user</code>
        </li>
        <li>
          <strong>Password:</strong>
          The value you specified for <code>--admin-password</code>
        </li>
      </ul>
    </div>
  </section>

  <!-- Success Section with Green Background -->
  <section class="bg-green-50 dark:bg-green-950/30 py-16">
    <div class="px-4 sm:px-6 mx-auto lg:px-8 max-w-4xl">
      <div class="flex items-center gap-4 mb-6">
        <div
          class="flex-shrink-0 w-16 h-16 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center"
        >
          <Icon name="tabler:confetti" class="w-8 h-8 text-green-600 dark:text-green-400" />
        </div>
        <div>
          <h2 class="text-3xl font-bold font-heading text-green-800 dark:text-green-200">
            Success! Your Store is Live
          </h2>
          <p class="text-green-700 dark:text-green-300">
            Congratulations! You now have a working Mage-OS installation.
          </p>
        </div>
      </div>

      <div
        class="prose prose-lg max-w-none dark:prose-invert prose-headings:text-green-800 dark:prose-headings:text-green-200 prose-a:text-green-700 dark:prose-a:text-green-300"
      >
        <h3>Essential Configuration</h3>

        <p>Access <strong>Admin &gt; Stores &gt; Configuration</strong> to configure:</p>

        <table class="bg-white dark:bg-gray-800 rounded-lg overflow-hidden">
          <thead class="bg-green-100 dark:bg-green-900">
            <tr>
              <th class="text-green-800 dark:text-green-200">Setting</th>
              <th class="text-green-800 dark:text-green-200">Location</th>
              <th class="text-green-800 dark:text-green-200">Purpose</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Store Information</td>
              <td>General &gt; General</td>
              <td>Store name, address, contact</td>
            </tr>
            <tr>
              <td>Base URLs</td>
              <td>General &gt; Web</td>
              <td>Secure URLs for production</td>
            </tr>
            <tr>
              <td>Payment Methods</td>
              <td>Sales &gt; Payment Methods</td>
              <td>Enable payment gateways</td>
            </tr>
            <tr>
              <td>Shipping Methods</td>
              <td>Sales &gt; Shipping Methods</td>
              <td>Configure shipping options</td>
            </tr>
            <tr>
              <td>Tax Rules</td>
              <td>Sales &gt; Tax</td>
              <td>Set up tax calculations</td>
            </tr>
          </tbody>
        </table>

        <h3>Set Up Cron Jobs</h3>

        <p>
          Mage-OS requires cron for scheduled tasks (indexing, emails, etc.). Use the built-in command to configure cron
          automatically:
        </p>

        <CodeBlock code="bin/magento cron:install" lang="bash" />

        <p>Verify the installation:</p>

        <CodeBlock code="bin/magento cron:status" lang="bash" />
      </div>
    </div>
  </section>

  <!-- Troubleshooting Section -->
  <section class="px-4 py-16 sm:px-6 mx-auto lg:px-8 max-w-4xl">
    <h2 class="text-3xl font-bold font-heading mb-8 dark:text-white">Troubleshooting</h2>

    <div class="space-y-6">
      <Callout type="warning" title="Blank Page After Installation">
        <p class="mb-2"><strong>Cause:</strong> Usually a cache or compilation issue.</p>
        <pre
          class="bg-gray-900 text-gray-100 p-3 rounded text-sm overflow-x-auto"><code class="language-bash">rm -rf var/cache/* var/page_cache/* generated/*
bin/magento setup:upgrade
bin/magento cache:flush</code></pre>
      </Callout>

      <Callout type="warning" title="404 Errors on Storefront Pages">
        <p class="mb-2"><strong>Cause:</strong> Apache mod_rewrite not enabled.</p>
        <pre
          class="bg-gray-900 text-gray-100 p-3 rounded text-sm overflow-x-auto"><code class="language-bash">sudo a2enmod rewrite
sudo systemctl restart apache2</code></pre>
        <p class="mt-2">
          For Nginx, ensure your configuration includes the rewrite rules. See the <a
            href="/get-started/installation#nginx-configuration"
            class="underline">Installation Guide</a
          >.
        </p>
      </Callout>

      <Callout type="warning" title="Composer Memory Limit Errors">
        <p class="mb-2"><strong>Cause:</strong> PHP memory limit too low for Composer.</p>
        <pre
          class="bg-gray-900 text-gray-100 p-3 rounded text-sm overflow-x-auto"><code>php -d memory_limit=1G /usr/local/bin/composer create-project ...</code></pre>
      </Callout>

      <Callout type="warning" title="OpenSearch Connection Failed">
        <p class="mb-2"><strong>Cause:</strong> OpenSearch service not running.</p>
        <p class="mb-2">Verify OpenSearch is running:</p>
        <pre
          class="bg-gray-900 text-gray-100 p-3 rounded text-sm overflow-x-auto"><code>curl http://localhost:9200</code></pre>
        <p class="mt-2">You should see a JSON response with cluster information. If not, start OpenSearch:</p>
        <pre
          class="bg-gray-900 text-gray-100 p-3 rounded text-sm overflow-x-auto mt-2"><code>sudo systemctl start opensearch</code></pre>
      </Callout>

      <Callout type="warning" title="Admin Login Not Working">
        <p class="mb-2"><strong>Cause:</strong> Two-factor authentication is enabled by default.</p>
        <p class="mb-2">
          Install the <a href="https://github.com/markshust/magento2-module-disabletwofactorauth" class="underline"
            >DisableTwoFactorAuth module</a
          > which automatically disables 2FA in developer mode while keeping it enabled in production:
        </p>
        <pre
          class="bg-gray-900 text-gray-100 p-3 rounded text-sm overflow-x-auto"><code class="language-bash">composer require --dev markshust/magento2-module-disabletwofactorauth
bin/magento module:enable MarkShust_DisableTwoFactorAuth
bin/magento setup:upgrade</code></pre>
      </Callout>

      <Callout type="warning" title="Static Content Not Loading (CSS/JS Missing)">
        <p class="mb-2"><strong>Cause:</strong> Static content not deployed or permissions issue.</p>
        <pre
          class="bg-gray-900 text-gray-100 p-3 rounded text-sm overflow-x-auto"><code class="language-bash">bin/magento setup:static-content:deploy -f
bin/magento cache:clean</code></pre>
      </Callout>
    </div>
  </section>

  <!-- Next Steps with ItemGrid -->
  <section class="px-4 py-16 sm:px-6 mx-auto lg:px-8 max-w-5xl bg-gray-50 dark:bg-slate-800/50">
    <div class="text-center mb-12">
      <h2 class="text-3xl font-bold font-heading mb-4 dark:text-white">Next Steps</h2>
      <p class="text-xl text-muted">Now that your store is running, explore these resources:</p>
    </div>

    <ItemGrid
      columns={2}
      items={[
        {
          title: 'Full Installation Guide',
          description: 'Detailed installation instructions for Docker, cloud hosting, and custom environments.',
          icon: 'tabler:server',
          callToAction: {
            text: 'View Guide',
            href: '/get-started/installation',
          },
        },
        {
          title: 'Migration Guide',
          description: 'Step-by-step instructions for migrating from Magento Open Source to Mage-OS.',
          icon: 'tabler:refresh',
          callToAction: {
            text: 'Start Migration',
            href: '/get-started/migration-guide',
          },
        },
        {
          title: 'System Requirements',
          description: 'Complete technical specifications for PHP, databases, search engines, and more.',
          icon: 'tabler:checklist',
          callToAction: {
            text: 'View Requirements',
            href: '/get-started/system-requirements',
          },
        },
        {
          title: 'Developer Documentation',
          description: 'Full developer documentation with API references, tutorials, and best practices.',
          icon: 'tabler:book',
          callToAction: {
            text: 'Read DevDocs',
            href: 'https://devdocs.mage-os.org',
            target: '_blank',
          },
        },
      ]}
    />
  </section>

  <CallToAction
    actions={[
      {
        variant: 'primary',
        text: 'Join Discord',
        href: '/discord-channel',
        icon: 'tabler:brand-discord',
      },
      {
        text: 'GitHub',
        href: 'https://github.com/mage-os',
        target: '_blank',
        icon: 'tabler:brand-github',
      },
      {
        text: 'Community Hub',
        href: '/community',
        icon: 'tabler:users',
      },
    ]}
  >
    <Fragment slot="title">Join the Community</Fragment>

    <Fragment slot="subtitle">
      Get help, share ideas, and connect with other Mage-OS developers and merchants.
    </Fragment>
  </CallToAction>
</Layout>
