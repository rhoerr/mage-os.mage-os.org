---
import { Icon } from 'astro-icon/components';
import { twMerge } from 'tailwind-merge';
import type { Item } from '~/types';

export interface Props {
  items?: Array<Item>;
  defaultIcon?: string;
  classes?: Record<string, string>;
}

const { items = [], classes = {}, defaultIcon } = Astro.props as Props;

const {
  container: containerClass = '',
  panel: panelClass = '',
  title: titleClass = '',
  description: descriptionClass = '',
  icon: defaultIconClass = '',
} = classes;
---

{
  items && items.length > 0 && (
    <ol class={twMerge('relative border-s-2 border-gray-200 dark:border-gray-700', containerClass)}>
      {items.map(({ title, description, icon, classes: itemClasses = {} }, index = 0) => (
        <li class={twMerge('mb-10 ms-6 last:mb-0', panelClass, itemClasses?.panel)}>
          {/* Icon circle on the timeline */}
          <span
            class={twMerge(
              'absolute flex items-center justify-center w-8 h-8 rounded-full -start-4 ring-4 ring-white dark:ring-gray-900',
              index === 0
                ? 'bg-primary text-white'
                : 'bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400',
              defaultIconClass,
              itemClasses?.icon
            )}
          >
            {(icon || defaultIcon) && <Icon name={icon || defaultIcon} class="w-4 h-4" />}
          </span>

          {/* Content */}
          <div class="p-4 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm">
            {title && (
              <h3
                class={twMerge('text-lg font-semibold text-gray-900 dark:text-white', titleClass, itemClasses?.title)}
                set:html={title}
              />
            )}
            {description && (
              <p
                class={twMerge('mt-2 text-gray-600 dark:text-gray-400', descriptionClass, itemClasses?.description)}
                set:html={description}
              />
            )}
          </div>
        </li>
      ))}
    </ol>
  )
}
